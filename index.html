<html>
<head>
  <title>Buzz </title>
  <script src="/js/socket.io.slim.js"></script>
  <script src="/js/jquery.js"></script>
  <!-- <script src="/js/jquery.js"></script> -->
  <link type="text/css" rel="stylesheet" href="/css/materialize.min.css"  media="screen,projection"/>
  <script src="/js/materialize.min.js"></script>
  <link type="text/css" rel="stylesheet" href="/css/main.css">
</head>

<body>
  <div class="container">
    <div class="row">
      <a href="#"><div id="startq" class="col s6 button">New Question</div></a>
      <a href="#"><div id="startgame" class="col s6 button">Start Game (not implemented)</div></a>
    </div>  

    <div class = "row" id = "question">
      <p id = "questionText"></p>

    </div>
    <div class="row">
      <a href="#"><div id="buzzer" class="col s6 disabled button">Buzz</div></a>
      <a href="#"><div id="reset" class="col s6 button">reset</div></a>
    </div>  
    <div class="messages"><ul id="messages"></ul></div>
    <div class="divider"></div>
    <p><b>Connections:</b></p>
    <ul id="connections"> </ul>
    <div class="divider"></div>
    <p>
      ========================================
      THIS IS AN EXPERIMENTAL VERSION OF QBBUZZ
      =========================================

    </p>
    <p><b>About QBBuzz:</b></p>
    <p id = "about">
      QBBuzz was built by Sky Li primarily for the Acton-Boxborough Quiz Bowl team. It allows users to connect to a synchronized buzzer online, helping to facilitate online practices. Players can name themselves, buzz, and see who buzzed. When a new player joins, the buzzer should be reset so that they can sync with everyone else. 
    </p>
    <p>
      QBBuzz was built with Node.JS using an Express framework for the server, socket.io for server-client communication, and MaterializeCSS for client UI. It is hosted on a free Heroku dyno.
    </p>
    <p>

      See the source code on GitHub <a href = "https://github.com/skyli42/Buzzer"> here</a>
    </p>
    <div id="modal1" class="modal">
      <div class="modal-content">
        <form id="name_form" >
          What is your name?
          <br />
          <input type="text" id="name" autocomplete = "off" autofocus="autofocus" onfocus="this.select()">
        </form>
      </div>
      <div class="modal-footer">
        <a href="#" id="submit_button" class="modal-action modal-close waves-effect waves-green btn-flat">Done</a>
      </div>
    </div>
  </div>
  <script src = "/js/globalVars.js"></script>
  <script src = "/js/reader.js"></script>
  <script src = "/js/socket.js"></script>
  <script src = "/js/buttons.js"></script>
  <script>
    $(document).ready(function(){
      $("#modal1").openModal({
        dismissible:false
      });
    });
    $(window).keypress(function (e) {
      if (event.which == 13 || event.keyCode == 13) { 
        socket.emit('new player', $('#name').val());
        $("#modal1").closeModal();
        return false;
      }
      else if (e.keyCode === 0 || e.keyCode === 32) {
        e.preventDefault()
        var focused = $(':focus');
        if(!focused.is("input") && !$('#buzzer').hasClass('disabled')){
          socket.emit('buzz', socket.id)
        }
        else if($('#buzzer').hasClass('disabled')){
          Materialize.toast("You can't buzz right now!", 2000)
        }
      }
      else if(e.keyCode === 82||e.keyCode === 114){
        socket.emit("reset")
      }
      else if(e.keyCode == 67||e.keyCode == 99){
        socket.emit("continue")
      }
      else return true;
    })
  </script>
</body>
</html>